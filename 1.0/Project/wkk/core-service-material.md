# 核心功能开发资料

这一部分主要是核心部分的开发的参考资料，一个是如何从笔记中提取出兴趣，建立用户模型，另一个就是如何根据这个模型，来进行对应的推荐，也就是**特征提取**和**推荐系统**

<!-- MarkdownTOC -->

- Daily Me
- Papers
- Books
- 推荐机制
    - 基于人口统计学的推荐
    - 基于内容的推荐
    - 基于项目的协同过滤推荐
        - 基于用户的协同过滤推荐
        - 基于项目的协同过滤推荐
        - 基于模型的协同过滤推荐
        - 混合的推荐机制
- 文本分析
- 推荐系统的坑
- 复杂系统

<!-- /MarkdownTOC -->

## Daily Me

The Daily Me is a term popularized by MIT Media Lab founder Nicholas Negroponte to describe a virtual daily newspaper customized for an individual's tastes. Negroponte discusses it in his 1995 book, Being Digital, referencing a project under way at the media lab, Fishwrap. Designed by Pascal Chesnais and Walter Bender and implemented by media lab students, the system allowed a greater deal of customization than commercially available systems in 1997

## Papers

+ Google News Personalization : Scalable Online Collaborative Filtering。谷歌新闻2006年的工作，主要内容包括相关算法和系统的构建。
+ Personalized News Recommendation Based on Click Behavior。谷歌新闻2009年的工作，与第一篇对比，可以看出他们思路上的一些转变。
+ Amazon 的一篇

1. The Wisdom of The Few 豆瓣阿稳在介绍豆瓣猜的时候极力推荐过这篇论文，豆瓣猜也充分应用了这篇论文中提出的算法；
2. Restricted Boltzmann Machines for Collaborative Filtering 目前Netflix使用的主要推荐算法之一；
3. Factorization Meets the Neighborhood: a Multifaceted Collaborative Filtering Model 这个无需强调重要性，LFM几乎应用到了每一个商业推荐系统中；
4. Collaborative Filtering with Temporal Dynamics 加入时间因素的SVD++模型，曾在Netflix Prize中大放溢彩的算法模型；
5. Context-Aware Recommender Systems 基于上下文的推荐模型，现在不论是工业界还是学术界都非常火的一个topic；
6. Toward the next generation of recommender systems 对下一代推荐系统的一个综述；
7. Item-Based Collaborative Filtering Recommendation Algorithms 基于物品的协同过滤，Amazon等电商网站的主力模型算法之一；
8. Information Seeking-Convergence of Search, Recommendations and Advertising 搜索、推荐和广告的大融合也是未来推荐系统的发展趋势之一；
9. Ad Click Prediction: a View from the Trenches 可以对推荐结果做CTR预测排序；
10. Performance of Recommender Algorithm on top-n Recommendation Task TopN预测的一个综合评测，TopN现在是推荐系统的主流话题，可以全部实现这篇文章中提到的算法大概对TopN有个体会；
11. http://dsec.pku.edu.cn/~jinlong/publication/wjlthesis.pdf 北大一博士对Netflix Prize算法的研究做的毕业论文，这篇论文本身对业界影响不大，但是Netflix Prize中运用到的算法极大地推动了推荐系统的发展；

## Books

+ 入门
    + 深入浅出数据分析 √
    + 啤酒与尿布 √
    + 数据之美
+ 数据分析
    + SciPy and NumPy
    + Python for Data Analysis
    + Bad Data Handbook
    + Machine Learning in Action (机器学习实战)
    + Building Machine Learning Systems with Python
+ 偏理论
    + 《数据挖掘导论》
    + 《数据挖掘：概念与技术》(原书第3版）
    + 《神经网络与机器学习》（原书第3版）
    + 《Web数据挖掘》
+ 偏实践
    + 《智能web算法》
    + 《集体智慧编程》 √
    + 《Collective Intelligence实战》
    + 《推荐系统实践》√
+ 《Recommender Systems Handbook》
+ 专业
    + Learning to Rank for Information Retrieval 刘铁岩
    + Learning to Rank for Information Retrieval and Natural Language Processing 李航

## 推荐机制

### 基于人口统计学的推荐

基于人口统计学的推荐机制（Demographic-based Recommendation）是一种最易于实现的推荐方法，它只是简单的根据系统用户的基本信息发现用户的相关程度，然后将相似用户喜爱的其他物品推荐给当前用户。

首先，系统对每个用户都有一个用户 Profile 的建模，其中包括用户的基本信息，例如用户的年龄，性别等等；然后，系统会根据用户的 Profile 计算用户的相似度，可以看到用户 A 的 Profile 和用户 C 一样，那么系统会认为用户 A 和 C 是相似用户，在推荐引擎中，可以称他们是“邻居”；最后，基于“邻居”用户群的喜好推荐给当前用户一些物品，图中将用户 A 喜欢的物品 A 推荐给用户 C。

这种基于人口统计学的推荐机制的好处在于：

+ 因为不使用当前用户对物品的喜好历史数据，所以对于新用户来讲没有“冷启动（Cold Start）”的问题。
+ 这个方法不依赖于物品本身的数据，所以这个方法在不同物品的领域都可以使用，它是领域独立的（domain-independent）

### 基于内容的推荐

基于内容的推荐是在推荐引擎出现之初应用最为广泛的推荐机制，它的核心思想是根据推荐物品或内容的元数据，发现物品或者内容的相关性，然后基于用户以往的喜好记录，推荐给用户相似的物品。

首先我们需要对电影的元数据有一个建模，这里只简单的描述了一下电影的类型；然后通过电影的元数据发现电影间的相似度，因为类型都是“爱情，浪漫”电影 A 和 C 被认为是相似的电影（当然，只根据类型是不够的，要得到更好的推荐，我们还可以考虑电影的导演，演员等等）；最后实现推荐，对于用户 A，他喜欢看电影 A，那么系统就可以给他推荐类似的电影 C。

这种基于内容的推荐机制的好处在于它能很好的建模用户的口味，能提供更加精确的推荐。但它也存在以下几个问题：

1. 需要对物品进行分析和建模，推荐的质量依赖于对物品模型的完整和全面程度。在现在的应用中我们可以观察到关键词和标签（Tag）被认为是描述物品元数据的一种简单有效的方法。
2. 物品相似度的分析仅仅依赖于物品本身的特征，这里没有考虑人对物品的态度。
3. 因为需要基于用户以往的喜好历史做出推荐，所以对于新用户有“冷启动”的问题。

虽然这个方法有很多不足和问题，但他还是成功的应用在一些电影，音乐，图书的社交站点，有些站点还请专业的人员对物品进行基因编码，比如潘多拉，在一份报告中说道，在潘多拉的推荐引擎中，每首歌有超过 100 个元数据特征，包括歌曲的风格，年份，演唱者等等。

### 基于项目的协同过滤推荐

随着 Web2.0 的发展，Web 站点更加提倡用户参与和用户贡献，因此基于协同过滤的推荐机制因运而生。它的原理很简单，就是根据用户对物品或者信息的偏好，发现物品或者内容本身的相关性，或者是发现用户的相关性，然后再基于这些关联性进行推荐。基于协同过滤的推荐可以分为三个子类：基于用户的推荐（User-based Recommendation），基于项目的推荐（Item-based Recommendation）和基于模型的推荐（Model-based Recommendation）。下面我们一个一个详细的介绍着三种协同过滤的推荐机制。

#### 基于用户的协同过滤推荐

基于用户的协同过滤推荐的基本原理是，根据所有用户对物品或者信息的偏好，发现与当前用户口味和偏好相似的“邻居”用户群，在一般的应用中是采用计算“K-邻居”的算法；然后，基于这 K 个邻居的历史偏好信息，为当前用户进行推荐。

假设用户 A 喜欢物品 A，物品 C，用户 B 喜欢物品 B，用户 C 喜欢物品 A ，物品 C 和物品 D；从这些用户的历史喜好信息中，我们可以发现用户 A 和用户 C 的口味和偏好是比较类似的，同时用户 C 还喜欢物品 D，那么我们可以推断用户 A 可能也喜欢物品 D，因此可以将物品 D 推荐给用户 A。

基于用户的协同过滤推荐机制和基于人口统计学的推荐机制都是计算用户的相似度，并基于“邻居”用户群计算推荐，但它们所不同的是如何计算用户的相似度，基于人口统计学的机制只考虑用户本身的特征，而基于用户的协同过滤机制可是在用户的历史偏好的数据上计算用户的相似度，它的基本假设是，喜欢类似物品的用户可能有相同或者相似的口味和偏好。

#### 基于项目的协同过滤推荐

基于项目的协同过滤推荐的基本原理也是类似的，只是说它使用所有用户对物品或者信息的偏好，发现物品和物品之间的相似度，然后根据用户的历史偏好信息，将类似的物品推荐给用户。

假设用户 A 喜欢物品 A 和物品 C，用户 B 喜欢物品 A，物品 B 和物品 C，用户 C 喜欢物品 A，从这些用户的历史喜好可以分析出物品 A 和物品 C 时比较类似的，喜欢物品 A 的人都喜欢物品 C，基于这个数据可以推断用户 C 很有可能也喜欢物品 C，所以系统会将物品 C 推荐给用户 C。

与上面讲的类似，基于项目的协同过滤推荐和基于内容的推荐其实都是基于物品相似度预测推荐，只是相似度计算的方法不一样，前者是从用户历史的偏好推断，而后者是基于物品本身的属性特征信息。

同时协同过滤，在基于用户和基于项目两个策略中应该如何选择呢？其实基于项目的协同过滤推荐机制是 Amazon 在基于用户的机制上改良的一种策略，因为在大部分的 Web 站点中，物品的个数是远远小于用户的数量的，而且物品的个数和相似度相对比较稳定，同时基于项目的机制比基于用户的实时性更好一些。但也不是所有的场景都是这样的情况，可以设想一下在一些新闻推荐系统中，也许物品，也就是新闻的个数可能大于用户的个数，而且新闻的更新程度也有很快，所以它的形似度依然不稳定。所以，其实可以看出，推荐策略的选择其实和具体的应用场景有很大的关系。

#### 基于模型的协同过滤推荐

基于模型的协同过滤推荐就是基于样本的用户喜好信息，训练一个推荐模型，然后根据实时的用户喜好的信息进行预测，计算推荐。

基于协同过滤的推荐机制是现今应用最为广泛的推荐机制，它有以下几个显著的优点：

+ 它不需要对物品或者用户进行严格的建模，而且不要求物品的描述是机器可理解的，所以这种方法也是领域无关的。
+ 这种方法计算出来的推荐是开放的，可以共用他人的经验，很好的支持用户发现潜在的兴趣偏好

而它也存在以下几个问题：

+ 方法的核心是基于历史数据，所以对新物品和新用户都有“冷启动”的问题。
+ 推荐的效果依赖于用户历史偏好数据的多少和准确性。
+ 在大部分的实现中，用户历史偏好是用稀疏矩阵进行存储的，而稀疏矩阵上的计算有些明显的问题，包括可能少部分人的错误偏好会对推荐的准确度有很大的影响等等。
+ 对于一些特殊品味的用户不能给予很好的推荐。
+ 由于以历史数据为基础，抓取和建模用户的偏好后，很难修改或者根据用户的使用演变，从而导致这个方法不够灵活。

#### 混合的推荐机制

在现行的 Web 站点上的推荐往往都不是单纯只采用了某一种推荐的机制和策略，他们往往是将多个方法混合在一起，从而达到更好的推荐效果。关于如何组合各个推荐机制，这里讲几种比较流行的组合方法。

+ 加权的混合（Weighted Hybridization）: 用线性公式（linear formula）将几种不同的推荐按照一定权重组合起来，具体权重的值需要在测试数据集上反复实验，从而达到最好的推荐效果。
+ 切换的混合（Switching Hybridization）：前面也讲到，其实对于不同的情况（数据量，系统运行状况，用户和物品的数目等），推荐策略可能有很大的不同，那么切换的混合方式，就是允许在不同的情况下，选择最为合适的推荐机制计算推荐。
+ 分区的混合（Mixed Hybridization）：采用多种推荐机制，并将不同的推荐结果分不同的区显示给用户。其实，Amazon，当当网等很多电子商务网站都是采用这样的方式，用户可以得到很全面的推荐，也更容易找到他们想要的东西。
+ 分层的混合（Meta-Level Hybridization）: 采用多种推荐机制，并将一个推荐机制的结果作为另一个的输入，从而综合各个推荐机制的优缺点，得到更加准确的推荐。

## 文本分析

一般是用词袋模型+隐含主题模型来完成。

在短文本的主题模型有一些研究工作，我没有全面做过调研，自己了解的包括：

1. KDD 2014上来自Twitter团队的Large-Scale High-Precision Topic Modeling on Twitter，对Twitter数据上进行主题模型建模做了大量定制化工作。
2. WWW 2008上的Learning to classify short and sparse text & web with hidden topics from large-scale data collections，专门研究如何用主题模型帮助解决短文本类分类的稀疏性问题。
3. ECIR 2011上的Comparing twitter and traditional media using topic models提出TwitterLDA，假设每条短文本只属于一个隐含主题，属于专门针对短文本隐含主题建模所做的合理性假设。

CHI、TFIDF既可以作为特征选取也可以作为权重计算的方法，不同之处在于TFIDF可以用于任意文本集合，而CHI则需要文本有分类标签的标记才能计算。

TextRank最初是作为关键词抽取方法提出来的，后来也有人尝试作为权重计算方法，但需要注意的是TextRank的计算复杂度很高，所以不建议实用中采用该算法。

## 推荐系统的坑

**第一坑：高估系统对用户需求的捕捉能力**

我们都说，搜索引擎是满足用户主动需求的产品，而推荐系统则是满足用户隐含需求的产品。当用户明确需要什么信息，就把需求转化为检索词，丢到搜索引擎，搜索引擎帮用户找到它，而推荐系统则能良好的感知用户未明确陈述的需求，为其呈现信息。那么问题来了，既然推荐系统能够捕捉用户的需求，也就是说用户还没丢关键词给搜索引擎之前已然知道用户要什么，直接为用户呈现出信息不更好？还需要搜索引擎干嘛？！

当然更好，当然很好，只是做不到。

用户的需求是多变的，其中暗含着某些规律，但却不可能被完全的，彻底的捕捉到，例如用户浏览一个商品页面，可能他对网页上的产品感兴趣，可能他被网页上的代言美女吸引，可能他在为女友准备礼物，可能他在为家人准备年货，也可能只是误操作罢了，这些细节被系统感知到的难度太大，所以我们无法知道用户下一步要去做什么，哪又如何推荐？

推荐系统有其边界，一切技术均有其边界，局限于当前技术成熟度，局限于数据，局限于现实世界与技术世界的距离。当产品经理不了解技术的边界，而技术人员则缺乏产品思维的时候，这种错误便容易发生。

**第二坑：不顾场景，强暴用户需求**

假设你非常喜欢榴莲蛋糕，任何人送你一款这样的蛋糕你都无比高兴，任何人推荐一款这样的蛋糕你一定会认真考虑。但是如果某一天你正在私宅床上与女友翻滚厮磨，有一人推门而入，问你：“根据俺们系统的分析，请问您是否需要一款美味的榴莲蛋糕？”，不知你是否感觉开心。而有一天你正在厕所，蹲坐在亲爱的马桶上，同样这个人也推开门问你“请问您是否需要一款美味的蛋糕？”你有没有不去把他打死的冲动？

这是典型的“不顾场景”的案例。

可能系统良好的挖掘了用户的需求，但是如果不顾场景，带来的将是用户巨大的反感。例如，我们公认的基于社交网络进行各种类型的推荐都是非常好的推荐思路：你所熟悉的人的行为对你有着非常好的借鉴作用。这一点没错。但是一般而言，对商品的推荐还是要放在商品售卖网站，对电影的推荐也请放在电影票售卖网站。浏览这些网站的用户，都带着强烈的隐含需求，但选错了地方，往往形成对用户的“强暴”，安能不败。

**第三坑：将“推荐”理解为“推送”**

继续第二个坑的故事，被揍的推销员遁回家后万般委屈，当脑海中萦绕着的“我咋知道你啥时候需要榴莲蛋糕，我咋知道你啥时候跟女友滚床单我咋知道你啥时候蹲厕所”的幽怨思绪沉寂下来后，痛定思痛决定不再到用户家里推销，而是告诉用户，需要蛋糕的时候打个电话给他，他会推荐几款最好的蛋糕给用户，终于避免了被揍并且收获了不菲订单。

嗯嗯..故事只是故事。只是用户渴望惊喜，又憎恨被打扰的折中究竟在哪？不妨变主动变被动，当下无数的互联网产品都有一个“发现”模块，包括微信，Twiiter等大量产品。用户有需求的时候，会主动的找“推荐”，避免被打搅。而对于推荐系统，也避免对用户形成打扰，引起用户反感。

**第四坑：不顾用户需求的“个性化”程度，粗暴技术选型**

我们将推荐系统的目标进行简化，假设它要解决的是点击率/转化率预估问题（但实际上远不止这个问题，本文不展开）。那么这些指标都与哪些因素有关？我们用“看岛国片子”为例，也就是说，用户点击/观看一部被推荐片子，都与哪些因素有关？

1. 平台的因素：一部片子放在官方的平台上，跟放在旮旯的小平台，完全一样的信息，这些数字显然不同
2. 片子本身的魅力：几部片子，即使有同样的静态信息（导演，女优，出品商等），一定也会有所差异，这些差异的原因非常难以捕捉，但通过历史信息却可以看到；
3. 片子信息造成的差异：例如一部片子是吉泽明步出演，另一部则是一位名不见经传的女同志出演，第一步被认可的概率必然大一些。
4. 用户的群体偏好：例如“搞IT的更加喜欢苍井空”，那么当一个人是IT从业者，苍老师的片子他应该更加喜欢；
5. 用户的个性化偏好：例如我的一位亲爱的同事喜欢松岛枫，理由是演技高超，气质高冷。那么松岛老师的片子他一定喜欢，同样的“演技高超，气质高冷”的几位演员，对他进行推荐也不错。

其中这几个因素，有一定的界限，其对应的技术选型也不同，如果只有平台的因素，点击率与转化率遵循Beta分布，只需要对这些值进行估计。而片子本身的魅力通过简单的历史信息统计便可得到。片子信息造成的差异，则可以通过典型的线性预估+属性特征进行处理。而如果有强烈的群体偏好，则可以在线性预估模型里面增加交叉特征，但是如果个性化需求极其强烈，那么协同过滤算法可能更加适合。

## 复杂系统

1. [奥]薛定谔著.生命是什么[M].湖南科学技术出版社，2003.9
2. [比]伊·普里戈金，[比]G·尼科里斯著.探索复杂性[M].四川教育出版社，1986.7
3. [比]伊·普里戈金，[法]伊·斯唐热著.从混沌到有序——人与自然的新对话[M].上海译文出版社，1987.8
4. [比]伊·普里戈金著.从存在到演化：自然科学中的时间及复杂性[M].北京大学出版社，2007.4
5. [德]艾根著.超循环论[M].上海译文出版社，1990.5
6. [德]赫尔曼·哈肯著.协同学——大自然构成的奥秘[M].上海译文出版社，2005.5
7. [德]克拉默著.混沌与秩序：生物系统的复杂结构[M].上海科技教育出版社，2000.8
8. [法]勒内·托姆著.突变论：思想和应用[M].上海译文出版社，1989.3
9. [美]埃里克·詹奇著.自组织的宇宙观[M].中国社会科学出版社，1992
10. [美]冯·贝塔朗菲著.一般系统论：基础、发展和应用[M].清华大学出版社，1987.6
11. [美]盖尔曼著.夸克与美洲豹：简单性和复杂性的奇遇[M]. 湖南科学技术出版社，1999.4
12. [美]洛伦兹著.混沌的本质[M].气象出版社，1997.1
13. [美]米歇尔·沃尔德洛普著.复杂——诞生于秩序与混沌边缘的科学[M].生活·读书·新知三联书店，1997.4
14. [美]斯图亚特·考夫曼著.科学新领域的探索[M].湖南科学技术出版社，2004.5
15. [美]斯图亚特·考夫曼著.宇宙为家[M].湖南科学技术出版社，2003.5
16. [美]维纳著.人有人的用处——控制论和社会[M].商务印书馆，1978.6
17. [美]约翰·霍兰著.隐秩序——适应性造就复杂性[M].上海科技教育出版社，2000.8
18. [美]约翰·霍兰著.涌现——从混沌到有序[M].上海科学技术出版社，2006.7
19. [美]詹姆斯·格莱克著.混沌：开创新科学[M].上海译文出版社，1990.8
